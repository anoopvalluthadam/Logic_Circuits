<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Twisted Documentation: Logic Circuits - Part One</title><link href="logic_files/py4fun.css" type="text/css" rel="stylesheet"></head><body bgcolor="white"><h1 class="title">Logic Circuits - Part One</h1><div class="toc"><ol></ol></div><div class="content"><span></span><p>There are several motivations for simulating logic circuits in Python.
First it is a nice simulation exercise. Second it shows off object oriented programming
well, especially the power of inheritance. Finally real logic circuits built
with electronic components are the basis for computer hardware. The simplest are
gates (AND, OR, NOT) made with only a few transistors and resisters. Since the mid
1960's these circuits have been fabricated in integrated circuits (chips). Before that
they were built with seperate transistors and resisters wired together on circuit
boards. Today you can purchase chips with, say, six NOT gates or four 2 input NAND
gates (an AND gate followed by a NOT) for as little as a quarter at your local electronics
retailer.</p><p>We will use a couple of Python classes to simulate the behavior of logic circuits. We
will have a base class LC (logic circuit) which will be subclassed to actual gates and
other circuits. A second class, Connector, will be used to provide inputs and outputs
to the logic circuits. An output connectors <em> connect</em> method will simulate the
wiring of LC's to one another.</p><p><a href="http://openbookproject.net//py4fun/logic/logic.py">Click Here for Full Python Source</a></p><p>We will start with 3 simple LC's and proceed to build everything else from them. When we are
done with this part we will have a LC that adds two binary numbers together. In the
next part we will see how the same simple LC's can be used to provide computer memory
and even multiplication of binary numbers.</p><p>Our 3 basic LC's are the two input AND and OR gates and the NOT gate (sometimes called
an inverter).</p><p>The AND gate has two inputs (generally labeled A and B) and and output C. The inputs and
output may have the value 0 or 1. The output C is 1 if and only if both A and B are 1.
Otherwise it is 0. (see fig. 1)</p><p><img src="logic_files/fig1.GIF"></p><p>The OR gate is very similar with the same inputs A and B, and output C. The output C
is 1 if either A or B is 1, Otherwise it is 0.</p><p>The NOT gate has a single input A and output B. The output is the opposite of the input. If
the input is 0, the output is 1. If the input is 1, the output is 0.</p><p>From these basic 3 LC's (or gates), everything else is built by using existing LC's and
connecting outputs to inputs in certain ways. For example to make a NAND gate where
the output C is 0 if and only if both inputs are 1, we can use and AND gate followed
by a NOT gate. The inputs of the AND gate are the inputs to the NAND. The AND output
is connected to the NOT input. The NOT output is the output for the NAND. See figure 2.</p><p><img src="logic_files/fig2.GIF"></p><p>A more interesting LC (see figure 3) is the XOR gate. It is built with 2 NOT's, 2
AND's and an OR gate. Its output C is 1 if the inputs A and B are not the same. We
can see how this works looking at the figure. The LC output is the OR gate output
and will be 1 if either of
the AND gate outputs are 1. The top AND gate output is 1 if input A is 1 and B is 0.
The lower AND gate output is 1 if A is 0 and B is 1. If A and B are the same, both
AND gate outputs are 0. You should convince yourself of this in more detail.</p><p><img src="logic_files/fig3.GIF"></p><p>Lets look at our Python classes now. The class Connector will provide inputs and
outputs for instances of the LC class (and subclasses). Each Connector will belong
to an owner and have a name. By convention the name is a string that reflects the
variable name we choose for the connector. This will let us monitor outputs during
execution. Every connector has a current value, either 0 or 1. This will change as
the program executes.</p><p>An output connector will normally be connected to one or more input connectors unless
it is a final output, in which case it will probably be monitored. Input connectors
will have their "activates" attribute true, so that when their value is changed they
wake up their owner (an LC) to reevaluate its output(s).</p><p>So this is the code to initialize a Connector instance</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">Connector</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">owner</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">,</span> <span class="py-src-parameter">activates</span><span class="py-src-op">=</span><span class="py-src-number">0</span><span class="py-src-op">,</span> <span class="py-src-parameter">monitor</span><span class="py-src-op">=</span><span class="py-src-number">0</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">value</span> <span class="py-src-op">=</span> <span class="py-src-variable">None</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">owner</span> <span class="py-src-op">=</span> <span class="py-src-variable">owner</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">name</span>  <span class="py-src-op">=</span> <span class="py-src-variable">name</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">monitor</span>  <span class="py-src-op">=</span> <span class="py-src-variable">monitor</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">connects</span> <span class="py-src-op">=</span> <span class="py-src-op">[</span><span class="py-src-op">]</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">activates</span><span class="py-src-op">=</span> <span class="py-src-variable">activates</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>For output connectors we will call the connect method to provide the output with
a list of its input connectors. For convenience, a single input does not have to
be placed in a list.</p><pre class="python"><span class="py-src-keyword">def</span> <span class="py-src-identifier">connect</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">inputs</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">if</span> <span class="py-src-variable">type</span><span class="py-src-op">(</span><span class="py-src-variable">inputs</span><span class="py-src-op">)</span> <span class="py-src-op">!=</span> <span class="py-src-variable">type</span><span class="py-src-op">(</span><span class="py-src-op">[</span><span class="py-src-op">]</span><span class="py-src-op">)</span> <span class="py-src-op">:</span> <span class="py-src-variable">inputs</span> <span class="py-src-op">=</span> <span class="py-src-op">[</span><span class="py-src-variable">inputs</span><span class="py-src-op">]</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">for</span> <span class="py-src-variable">input</span> <span class="py-src-keyword">in</span> <span class="py-src-variable">inputs</span> <span class="py-src-op">:</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">connects</span><span class="py-src-op">.</span><span class="py-src-variable">append</span><span class="py-src-op">(</span><span class="py-src-variable">input</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>The set method will be called from different places depending on whether we have an
input or output connector. Outputs
will be set by their owners evaluation functions. Outputs will in turn set their
inputs. As an input is set, it triggers its owners evaluation, cascading the logic
activity. If a connector is being monitored (self.monitor==1) it prints the owners name, its
own name and the value it is being set to.</p><pre class="python"><span class="py-src-keyword">def</span> <span class="py-src-identifier">set</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">value</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">if</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">value</span> <span class="py-src-op">==</span> <span class="py-src-variable">value</span> <span class="py-src-op">:</span> <span class="py-src-keyword">return</span>      <span class="py-src-comment"># Ignore if no change</span><span class="py-src-newline">
</span>   <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">value</span> <span class="py-src-op">=</span> <span class="py-src-variable">value</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">if</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">activates</span> <span class="py-src-op">:</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">owner</span><span class="py-src-op">.</span><span class="py-src-variable">evaluate</span><span class="py-src-op">(</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">if</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">monitor</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-keyword">print</span> <span class="py-src-string">"Connector %s-%s set to %d"</span> <span class="py-src-op">%</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">owner</span><span class="py-src-op">.</span><span class="py-src-variable">name</span><span class="py-src-op">,</span><span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">name</span><span class="py-src-op">,</span><span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-keyword">for</span> <span class="py-src-variable">con</span> <span class="py-src-keyword">in</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">connects</span> <span class="py-src-op">:</span> <span class="py-src-variable">con</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">value</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Logic circuits will be simulated in the LC class and its subclasses. There are two types of
logic circuits, simple and composite. Simple logic circuits have inputs, outputs, and an
evaluate method. Composite circuits have inputs, outputs, and a collection of internal LC's
and connector objects "wired" together. Each input of a composite LC will be connected to an
input of an internal LC. Likewise each output of the composited LC will come from an output
of an internal LC. For Composite LC's the evaluation function is unused.</p><p>Our base class LC is a virtual class. That is, we won't build instances (objects) from it
directly. It will be subclassed to more useful purposes. It provides the logic to give an
LC a name and a default evaluation function.</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">LC</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span>   <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">name</span> <span class="py-src-op">=</span> <span class="py-src-variable">name</span><span class="py-src-newline">
</span><span class="py-src-nl">
</span>   <span class="py-src-keyword">def</span> <span class="py-src-identifier">evaluate</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">)</span> <span class="py-src-op">:</span> <span class="py-src-keyword">return</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Our first real LC is a NOT gate or inverter. It calls its superclass, sets up an input
connector A, an output connector B, and an evaluation method. The evaluation method
sets B to 1 if A is zero, or B to 0 if A is 1. A Not LC is a example of a simple LC.</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">Not</span> <span class="py-src-op">(</span><span class="py-src-parameter">LC</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>         <span class="py-src-comment"># Inverter. Input A. Output B.</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">LC</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'A'</span><span class="py-src-op">,</span><span class="py-src-variable">activates</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'B'</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-nl">
</span>   <span class="py-src-dedent"></span><span class="py-src-keyword">def</span> <span class="py-src-identifier">evaluate</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">)</span> <span class="py-src-op">:</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-keyword">not</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Next we will define classes for our other two simple LC's, the AND and OR gates. First
lets define a convenience class for two input gates in general that have inputs named
A and B and an output C.</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">Gate2</span> <span class="py-src-op">(</span><span class="py-src-parameter">LC</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>  <span class="py-src-comment"># two input gates. Inputs A, B. Output C.</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">LC</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'A'</span><span class="py-src-op">,</span><span class="py-src-variable">activates</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'B'</span><span class="py-src-op">,</span><span class="py-src-variable">activates</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">C</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'C'</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>With that out of the way we just have to add evaluation functions to make the AND or OR
classes.</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">And</span> <span class="py-src-op">(</span><span class="py-src-parameter">Gate2</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>       <span class="py-src-comment"># two input AND Gate</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">Gate2</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-nl">
</span>   <span class="py-src-dedent"></span><span class="py-src-keyword">def</span> <span class="py-src-identifier">evaluate</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">)</span> <span class="py-src-op">:</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">value</span> <span class="py-src-keyword">and</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-nl">
</span><span class="py-src-dedent"></span><span class="py-src-keyword">class</span> <span class="py-src-identifier">Or</span> <span class="py-src-op">(</span><span class="py-src-parameter">Gate2</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>         <span class="py-src-comment"># two input OR gate.</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">Gate2</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-nl">
</span>   <span class="py-src-dedent"></span><span class="py-src-keyword">def</span> <span class="py-src-identifier">evaluate</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">)</span> <span class="py-src-op">:</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">value</span> <span class="py-src-keyword">or</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Let's play with this a bit. We'll instantiate an AND gate, set its output for
monitoring and then set its input connectors both to 1.</p><pre class="shell">&gt;&gt;&gt; from logic import *
&gt;&gt;&gt; a = And('A1')
&gt;&gt;&gt; a.C.monitor=1
&gt;&gt;&gt; a.A.set(1)
&gt;&gt;&gt; a.B.set(1)
Connector A1-C set to 1
</pre><p>Next we will instantiate an inverter (NOT gate) and connect it to the output of
the AND gate. See figure 2. Then we'll change one the inputs.</p><pre class="python-interpreter">&gt;&gt;&gt; n = Not('N1')
&gt;&gt;&gt; a.C.connect(n.A)
&gt;&gt;&gt; n.B.monitor=1
&gt;&gt;&gt; a.B.set(0)
Connector A1-C set to 0
Connector N1-B set to 1
&gt;&gt;&gt;
</pre><p>Now we will build a class for a composite LC, the XOR gate. See figure 3. When an instance
of an Xor is built, we grab 2 AND gates, 2 Inverters, and an OR gate and wire them
up as shown in the figure. Notice in particular how we connect the external input (self.A)
to an input of an internal gate (self.A1.A)</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">Xor</span> <span class="py-src-op">(</span><span class="py-src-parameter">Gate2</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">Gate2</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span> <span class="py-src-op">=</span> <span class="py-src-variable">And</span><span class="py-src-op">(</span><span class="py-src-string">"A1"</span><span class="py-src-op">)</span> <span class="py-src-comment"># See circuit drawing to follow connections</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A2</span> <span class="py-src-op">=</span> <span class="py-src-variable">And</span><span class="py-src-op">(</span><span class="py-src-string">"A2"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">I1</span> <span class="py-src-op">=</span> <span class="py-src-variable">Not</span><span class="py-src-op">(</span><span class="py-src-string">"I1"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">I2</span> <span class="py-src-op">=</span> <span class="py-src-variable">Not</span><span class="py-src-op">(</span><span class="py-src-string">"I2"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span> <span class="py-src-op">=</span> <span class="py-src-variable">Or</span> <span class="py-src-op">(</span><span class="py-src-string">"O1"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>    <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">,</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">I2</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>    <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">I1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">,</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A2</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">I1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">I2</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A2</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A2</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">C</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>So let's play with an XOR gate for a minute. Remember the output should be 1 if the inputs are
different.</p><pre class="python-interpreter">&gt;&gt;&gt; o1 = Xor('o1')
&gt;&gt;&gt; o1.C.monitor=1
&gt;&gt;&gt; o1.A.set(0)
&gt;&gt;&gt; o1.B.set(0)
Connector o1-C set to 0
&gt;&gt;&gt; o1.B.set(1)
Connector o1-C set to 1
&gt;&gt;&gt; o1.A.set(1)
Connector o1-C set to 0
&gt;&gt;&gt;
</pre><p>Now, finally, we are ready to talk about addition. So let's start with something familiar.
Suppose we want to add 168 and 234. Hmm. 8 plus 4 is 2 and carry 1. 1 plus 6 plus 3 is
0 and carry a 1. Finally 1 plus 1 plus 2 is 4. Answer 402.</p><p>So when we were all 7 years old we memorized 100 (10 times 10) rules
of addition like 8+4=12 (or 2 and carry 1). Of course if you get tricky and remember that
8+4 is the same as 4+8 and that zero plus anything is just that anything, you can
reduce the amount of memorization to 45 items.</p><p>In binary it is so much simpler. 4 rules (2 times 2) instead of 100. If you are tricky,
just 1. Basically that 1+1=2 (well 10, that is 0 and carry 1). Now to represent a number
in binary requires about 3.5 times as many digits as decimal but you can start to see that
this may be a good tradeoff.</p><p>Actually so far we're just talking about the first (rightmost) column. There is no carry
in yet. But bear with me for a moment. Lets summarize the 4 rules of binary addition</p><pre class="shell">   0 + 0 = 0
   0 + 1 = 1
   1 + 0 = 1
   1 + 1 = 0  and carry a 1
</pre><p>We will build a half adder circuit with 2 inputs and 2 outputs. See figure 4. The Sum output
is the same as the XOR gate above. That is the sum bit is one if one and only one of the
input bits is 1. The carry out is 1 only if both inputs are 1. For that we need an AND
gate.</p><p><img src="logic_files/fig4.GIF"></p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">HalfAdder</span> <span class="py-src-op">(</span><span class="py-src-parameter">LC</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>         <span class="py-src-comment"># One bit adder, A,B in. Sum and Carry out</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">LC</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'A'</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'B'</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">S</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'S'</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">C</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'C'</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">X1</span><span class="py-src-op">=</span> <span class="py-src-variable">Xor</span><span class="py-src-op">(</span><span class="py-src-string">"X1"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">=</span> <span class="py-src-variable">And</span><span class="py-src-op">(</span><span class="py-src-string">"A1"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>    <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">X1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">,</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>    <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">X1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">,</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">X1</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A1</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Let's build a half adder, monitor its outputs as we play with the inputs</p><pre class="python-interpreter">&gt;&gt;&gt; h1 = HalfAdder("H1")
&gt;&gt;&gt; h1.S.monitor=1
&gt;&gt;&gt; h1.C.monitor=1
&gt;&gt;&gt; h1.A.set(0)
Connector H1-C set to 0
&gt;&gt;&gt; h1.B.set(0)
Connector H1-S set to 0
&gt;&gt;&gt; h1.B.set(1)
Connector H1-S set to 1
&gt;&gt;&gt; h1.A.set(1)
Connector H1-S set to 0
Connector H1-C set to 1
&gt;&gt;&gt;
</pre><p>Now we're ready for the coup de grace. Let's go back to decimal for just a moment. Suppose
we are adding the following.</p><pre class="shell">   189
   243
</pre><p>and we are working on the middle column. We'll have a carry in of 1 (9+3=2, carry the 1) plus
8 plus 4. We'll add the 8 and 4 to get 12 (actually 2 and carry a 1) and then add the
carry in 1 to the 2 to get 3 for sum digit. In the 2 additions, at most only one will
generate a carry. You might want to play with some examples to convince yourself of this.</p><p>Look at figure 5. We add A and B and take the sum bit and add it to the carry in bit. Only
one of these additions might produce a carry out which is propogated to the next column.</p><p><img src="logic_files/fig5.GIF"></p><p>So here is our class for a full adder. 3 inputs, 2 outputs, and wired like shown in the
figure.</p><pre class="python"><span class="py-src-keyword">class</span> <span class="py-src-identifier">FullAdder</span> <span class="py-src-op">(</span><span class="py-src-parameter">LC</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>         <span class="py-src-comment"># One bit adder, A,B,Cin in. Sum and Cout out</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">__init__</span> <span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">name</span><span class="py-src-op">)</span> <span class="py-src-op">:</span><span class="py-src-newline">
</span><span class="py-src-indent">      </span><span class="py-src-variable">LC</span><span class="py-src-op">.</span><span class="py-src-variable">__init__</span> <span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span> <span class="py-src-variable">name</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span>    <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'A'</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">,</span><span class="py-src-variable">monitor</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span>    <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'B'</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">,</span><span class="py-src-variable">monitor</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">Cin</span>  <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'Cin'</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">,</span><span class="py-src-variable">monitor</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">S</span>    <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'S'</span><span class="py-src-op">,</span><span class="py-src-variable">monitor</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">Cout</span> <span class="py-src-op">=</span> <span class="py-src-variable">Connector</span><span class="py-src-op">(</span><span class="py-src-variable">self</span><span class="py-src-op">,</span><span class="py-src-string">'Cout'</span><span class="py-src-op">,</span><span class="py-src-variable">monitor</span><span class="py-src-op">=</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H1</span><span class="py-src-op">=</span> <span class="py-src-variable">HalfAdder</span><span class="py-src-op">(</span><span class="py-src-string">"H1"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H2</span><span class="py-src-op">=</span> <span class="py-src-variable">HalfAdder</span><span class="py-src-op">(</span><span class="py-src-string">"H2"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">=</span> <span class="py-src-variable">Or</span><span class="py-src-op">(</span><span class="py-src-string">"O1"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>    <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>    <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">Cin</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span>  <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H2</span><span class="py-src-op">.</span><span class="py-src-variable">A</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H1</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H2</span><span class="py-src-op">.</span><span class="py-src-variable">B</span> <span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H1</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H2</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">H2</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>      <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">O1</span><span class="py-src-op">.</span><span class="py-src-variable">C</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span> <span class="py-src-op">(</span><span class="py-src-op">[</span> <span class="py-src-variable">self</span><span class="py-src-op">.</span><span class="py-src-variable">Cout</span><span class="py-src-op">]</span><span class="py-src-op">)</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Instead of playing with a single full adder (you are welcome to, of course), we will cut
to the chase and write a function that wires up four full adders and let's us
do addition in binary. Figure 6 is a schematic of our circuit.</p><p><img src="logic_files/fig6.GIF"></p><p>We will represent a binary number in a string of zeros and ones.
For example '0101'. We'll use a helper function to extract a bit from a given position
as an actual 0 or 1 instead of a character.</p><pre class="python"><span class="py-src-keyword">def</span> <span class="py-src-identifier">bit</span> <span class="py-src-op">(</span><span class="py-src-parameter">x</span><span class="py-src-op">,</span> <span class="py-src-parameter">bit</span><span class="py-src-op">)</span> <span class="py-src-op">:</span> <span class="py-src-keyword">return</span> <span class="py-src-variable">x</span><span class="py-src-op">[</span><span class="py-src-variable">bit</span><span class="py-src-op">]</span><span class="py-src-op">==</span><span class="py-src-string">'1'</span><span class="py-src-newline">
</span><span class="py-src-endmarker"></span></pre><p>Our test function will take in two binary numbers (as strings), build an 4 bit adder,
set the inputs and then print out the result, including the final carry out.
Just as in decimal, where 2 four digit numbers may sum to a five digit result, we
need to provide the last carry out as a digit too.</p><pre class="python"><span class="py-src-keyword">def</span> <span class="py-src-identifier">test4Bit</span> <span class="py-src-op">(</span><span class="py-src-parameter">a</span><span class="py-src-op">,</span> <span class="py-src-parameter">b</span><span class="py-src-op">)</span> <span class="py-src-op">:</span>    <span class="py-src-comment"># a, b four char strings like '0110'</span><span class="py-src-newline">
</span><span class="py-src-indent">   </span><span class="py-src-variable">F0</span> <span class="py-src-op">=</span> <span class="py-src-variable">FullAdder</span> <span class="py-src-op">(</span><span class="py-src-string">"F0"</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F1</span> <span class="py-src-op">=</span> <span class="py-src-variable">FullAdder</span> <span class="py-src-op">(</span><span class="py-src-string">"F1"</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F0</span><span class="py-src-op">.</span><span class="py-src-variable">Cout</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span><span class="py-src-op">(</span><span class="py-src-variable">F1</span><span class="py-src-op">.</span><span class="py-src-variable">Cin</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F2</span> <span class="py-src-op">=</span> <span class="py-src-variable">FullAdder</span> <span class="py-src-op">(</span><span class="py-src-string">"F2"</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F1</span><span class="py-src-op">.</span><span class="py-src-variable">Cout</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span><span class="py-src-op">(</span><span class="py-src-variable">F2</span><span class="py-src-op">.</span><span class="py-src-variable">Cin</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F3</span> <span class="py-src-op">=</span> <span class="py-src-variable">FullAdder</span> <span class="py-src-op">(</span><span class="py-src-string">"F3"</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F2</span><span class="py-src-op">.</span><span class="py-src-variable">Cout</span><span class="py-src-op">.</span><span class="py-src-variable">connect</span><span class="py-src-op">(</span><span class="py-src-variable">F3</span><span class="py-src-op">.</span><span class="py-src-variable">Cin</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-nl">
</span>   <span class="py-src-variable">F0</span><span class="py-src-op">.</span><span class="py-src-variable">Cin</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-number">0</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F0</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">a</span><span class="py-src-op">,</span><span class="py-src-number">3</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F0</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">b</span><span class="py-src-op">,</span><span class="py-src-number">3</span><span class="py-src-op">)</span><span class="py-src-op">)</span>  <span class="py-src-comment"># bits in lists are reversed from natural order</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F1</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">a</span><span class="py-src-op">,</span><span class="py-src-number">2</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F1</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">b</span><span class="py-src-op">,</span><span class="py-src-number">2</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F2</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">a</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F2</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">b</span><span class="py-src-op">,</span><span class="py-src-number">1</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-variable">F3</span><span class="py-src-op">.</span><span class="py-src-variable">A</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">a</span><span class="py-src-op">,</span><span class="py-src-number">0</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-op">;</span> <span class="py-src-variable">F3</span><span class="py-src-op">.</span><span class="py-src-variable">B</span><span class="py-src-op">.</span><span class="py-src-variable">set</span><span class="py-src-op">(</span><span class="py-src-variable">bit</span><span class="py-src-op">(</span><span class="py-src-variable">b</span><span class="py-src-op">,</span><span class="py-src-number">0</span><span class="py-src-op">)</span><span class="py-src-op">)</span><span class="py-src-newline">
</span>   <span class="py-src-nl">
</span>   <span class="py-src-keyword">print</span> <span class="py-src-variable">F3</span><span class="py-src-op">.</span><span class="py-src-variable">Cout</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">,</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">print</span> <span class="py-src-variable">F3</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">,</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">print</span> <span class="py-src-variable">F2</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">,</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">print</span> <span class="py-src-variable">F1</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">,</span><span class="py-src-newline">
</span>   <span class="py-src-keyword">print</span> <span class="py-src-variable">F0</span><span class="py-src-op">.</span><span class="py-src-variable">S</span><span class="py-src-op">.</span><span class="py-src-variable">value</span><span class="py-src-op">,</span><span class="py-src-newline">
</span><span class="py-src-dedent"></span><span class="py-src-endmarker"></span></pre><p>Let's try it out. Notice that in the FullAdder class definition we told it to monitor
all inputs and outputs. This will let us watch the logic cascade.</p><pre class="python-interpreter">&gt;&gt;&gt; test4Bit ('0100','0010')
Connector F0-Cin set to 0
Connector F0-A set to 0
Connector F0-Cout set to 0
Connector F1-Cin set to 0
Connector F0-B set to 0
Connector F0-S set to 0
Connector F1-A set to 0
Connector F1-Cout set to 0
Connector F2-Cin set to 0
Connector F1-B set to 1
Connector F1-S set to 1
Connector F2-A set to 1
Connector F2-B set to 0
Connector F2-S set to 1
Connector F2-Cout set to 0
Connector F3-Cin set to 0
Connector F3-A set to 0
Connector F3-Cout set to 0
Connector F3-B set to 0
Connector F3-S set to 0
0 0 1 1 0
&gt;&gt;&gt;
</pre><p>Or, in other words, 2+4=6.
In case you think there is any cheating going on, search for the '+' character in
the file logic.py. You won't find one.</p>
<p id="Footer"><a href="http://www.gnu.org/copyleft/copyleft.html">
Copyright</a> © 2004-2009 Chris Meyers</p>
</div><p><a href="http://openbookproject.net//py4fun/index.html">Index</a></p></body></html>